Similar to version 1 but uses SQL database to store the information.
